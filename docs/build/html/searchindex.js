Search.setIndex({"docnames": ["fresco", "fresco.data_loaders", "fresco.models", "fresco.training", "fresco.validate", "index", "modules"], "filenames": ["fresco.rst", "fresco.data_loaders.rst", "fresco.models.rst", "fresco.training.rst", "fresco.validate.rst", "index.rst", "modules.rst"], "titles": ["fresco package", "fresco.data_loaders package", "fresco.models package", "fresco.training package", "fresco.validate package", "Welcome to FrESCO\u2019s documentation!", "fresco"], "terms": {"data_load": [0, 5, 6], "data_util": [0, 6], "model": [0, 1, 3, 4, 5, 6], "clc": [0, 1, 3, 6], "mtcnn": [0, 6], "mthisan": [0, 6], "train": [0, 1, 2, 5, 6], "valid": [0, 3, 5, 6], "except": [0, 6], "validate_param": [0, 6], "main": [0, 3], "sourc": [0, 1, 2, 3, 4], "word2int": 0, "d": 0, "top": 0, "level": [0, 1, 2, 3], "build": [0, 1, 4], "script": 0, "us": [0, 1, 2, 3], "independ": 0, "create_doc_embed": 0, "model_typ": 0, "devic": [0, 1, 2, 3], "gener": [0, 1, 4], "document": [0, 1, 2, 3], "embed": [0, 2], "from": [0, 1, 2, 3, 4], "create_model": 0, "param": 0, "dw": [0, 3], "defin": [0, 1], "base": [0, 1, 2, 3, 4], "model_arg": [0, 1, 4], "paramet": [0, 1, 2, 3, 4], "dict": [0, 1, 3, 4], "dictionari": [0, 1, 3], "file": [0, 1, 4], "datahandl": [0, 1, 3], "class": [0, 1, 2, 3, 4], "object": [0, 1, 3, 4], "torch": [0, 1, 2, 3], "either": 0, "cpu": [0, 3], "cuda": [0, 2, 3], "return": [0, 1, 2, 3], "A": 0, "load_model": 0, "model_dict": 0, "load_model_dict": 0, "model_path": 0, "data_path": [0, 4], "load": [0, 1, 4], "pretrain": [0, 4], "disk": 0, "str": [0, 1, 3, 4], "path": [0, 3, 4], "save": [0, 3], "command": [0, 4], "line": [0, 1, 2, 4], "arg": [0, 4], "valid_param": 0, "validateparam": [0, 4], "none": [0, 1, 2, 3, 4], "data": [0, 1, 4], "we": [0, 1, 3], "check": [0, 4], "suppli": 0, "match": [0, 2], "need": [0, 1, 4], "run": 0, "run_case_level": 0, "save_full_model": 0, "kw_arg": [0, 3, 4], "save_path": 0, "fold": [0, 1, 3], "info": 0, "metadata": [0, 1], "inform": 0, "extract": 0, "obtain": 0, "set": [0, 1, 4], "call": [0, 1, 3], "function": [0, 1, 3], "instanc": 0, "wrangl": 0, "post": [0, 1, 3, 4], "condit": [0, 1, 3, 4], "The": [0, 1, 2], "eval": 0, "mode": 0, "pre": [1, 4], "addnois": 1, "unk_token": 1, "max_pad_len": 1, "vocab_s": 1, "switch_rat": 1, "seed": 1, "option": [1, 4], "transform": 1, "pathreport": [1, 3], "dataset": [1, 4], "thi": [1, 2], "add": [1, 2], "random": 1, "amount": 1, "pad": [1, 2], "front": 1, "reduc": 1, "hisan": [1, 4], "overfit": 1, "It": [1, 3], "also": 1, "randomli": 1, "replac": 1, "word": [1, 2], "select": 1, "other": 1, "int": [1, 2, 3], "integ": [1, 2], "map": [1, 2], "unknown": 1, "token": [1, 2], "maximum": [1, 2, 3], "size": [1, 2], "vocabulari": 1, "matrix": [1, 2], "valu": [1, 3], "when": 1, "float": [1, 2, 3], "0": [1, 2], "1": [1, 2, 3], "percentag": 1, "default": [1, 2], "data_sourc": [1, 4], "clc_flag": 1, "bool": [1, 2, 3, 4], "fals": [1, 2, 3, 4], "how": 1, "wa": 1, "pipelin": 1, "offici": 1, "implement": 1, "type": [1, 2, 3], "keyword": [1, 3, 4], "necessari": [1, 4], "note": [1, 2, 4], "present": [1, 4], "onli": 1, "cannot": 1, "more": 1, "than": 1, "one": [1, 4], "convert_i": 1, "task": [1, 2, 3], "label": [1, 3], "y": [1, 3], "infer": 1, "frame": 1, "output": [1, 2], "ys": 1, "modifi": [1, 4], "place": 1, "string": [1, 3], "i": 1, "e": 1, "c50": 1, "48": 1, "site": 1, "If": [1, 3], "separ": 1, "creat": 1, "dataload": [1, 3], "should": [1, 2, 4], "you": 1, "want": 1, "get_vocab": 1, "get": [1, 3], "vocab": 1, "load_fold": 1, "subset_frac": 1, "each": [1, 2, 3], "number": [1, 2, 3, 4], "proport": 1, "__init__": 1, "attribut": 1, "popul": [1, 3], "case": [1, 2, 3], "context": [1, 2, 3], "see": 1, "run_clc": [1, 5, 6], "py": 1, "225": 1, "load_from_sav": 1, "alwai": 1, "now": 1, "self": [1, 2, 3, 4], "split": [1, 2], "load_weight": 1, "weight": [1, 3, 4], "pickl": 1, "make_grouped_cas": 1, "doc_emb": [1, 2], "clc_arg": 1, "groupedcas": 1, "make_torch_dataload": 1, "reproduc": 1, "pytorch": [1, 3], "val": [1, 3], "test": 1, "unk_tok": 1, "convert": 1, "flip": 1, "static": 1, "seed_work": 1, "worker_id": 1, "everyth": 1, "exclude_singl": 1, "true": [1, 2], "shuffle_data_ord": 1, "group": 1, "labeldict": 1, "miss": 1, "subclass": 1, "correct": 1, "behaviour": 1, "unk": 1, "x": [1, 2], "label_encod": 1, "max_len": 1, "3000": 1, "multilabel": [1, 3], "caselevelcontext": 2, "num_class": 2, "doc_embed_s": 2, "400": 2, "att_dim_per_head": 2, "50": 2, "att_head": 2, "8": 2, "att_dropout": 2, "forward_mask": 2, "forward": [2, 3], "num_doc": 2, "pass": [2, 3], "tensor": [2, 3], "shape": 2, "batch_siz": 2, "max_seq_length": 2, "report": 2, "per": [2, 3], "embedding_matrix": 2, "window_s": 2, "num_filt": 2, "dropout": 2, "5": 2, "bag_of_embed": 2, "embeddings_scal": 2, "20": 2, "multitask": 2, "simpl": [2, 4], "text": 2, "cnn": 2, "classifi": [2, 3], "cancer": 2, "patholog": 2, "numpi": [2, 3], "arrai": 2, "row": 2, "repres": 2, "index": [2, 3, 5], "mask": 2, "so": 2, "first": 2, "ignor": 2, "list": [2, 3, 4], "possibl": 2, "3": 2, "4": 2, "window": [2, 4], "consecut": 2, "examin": 2, "parallel": 2, "convolut": 2, "layer": 2, "must": 2, "length": 2, "300": 2, "filter": [2, 4], "rate": [2, 3], "appli": 2, "final": 2, "after": 2, "maxpool": 2, "bag": 2, "concaten": 2, "2": 2, "scale": [2, 3], "column": 2, "doc": 2, "return_emb": 2, "mt": 2, "batch": [2, 3], "indic": [2, 4], "predict": [2, 3], "logit": [2, 3], "max_words_per_lin": [2, 4], "max_lin": [2, 4], "hierarch": 2, "attent": 2, "network": 2, "smaller": 2, "chunk": 2, "addit": 2, "beyond": 2, "limit": 2, "ar": [2, 3, 4], "dimens": 2, "head": 2, "total": 2, "multihead": 2, "softmax": 2, "intermedi": 2, "concat": 2, "flexibl": 2, "oper": 2, "target": 2, "q": 2, "seq_len": 2, "dim1": 2, "k": 2, "v": 2, "dim2": 2, "have": 2, "same": 2, "can": [2, 3], "differ": [2, 4], "drop": 2, "nn": 2, "mask_q": 2, "boolean": 2, "mask_k": 2, "mask_v": 2, "deep": 3, "learn": 3, "modeltrain": 3, "class_weight": 3, "definit": 3, "savepath": 3, "metric": 3, "epoch": 3, "patience_stop": 3, "patienc": 3, "stop": 3, "criteria": 3, "n_task": 3, "ntask": 3, "declar": 3, "initi": 3, "caller": 3, "best_loss": 3, "best": 3, "loss": 3, "score": 3, "patience_ctr": 3, "counter": 3, "y_pred": 3, "usual": 3, "y_true": 3, "ground": 3, "truth": 3, "classif": 3, "abstain": 3, "mixed_precis": 3, "automat": 3, "mix": 3, "precis": 3, "opt": 3, "optim": 3, "reduct": 3, "loss_fun": 3, "scheme": 3, "compute_clc_loss": 3, "idx": 3, "dac": 3, "comput": 3, "iter": 3, "abstent": [3, 4], "ntask_ab": 3, "probabl": 3, "entir": 3, "updat": [3, 4], "compute_clc_val_loss": 3, "compute_loss": 3, "compute_scor": 3, "macro": 3, "micro": 3, "compute_val_loss": 3, "fit_model": 3, "train_load": 3, "val_load": 3, "loop": 3, "get_i": 3, "y_predict": 3, "ndarrai": 3, "kei": 3, "enumer": 3, "output_scor": 3, "abs_scor": 3, "stop_val": 3, "alpha_scal": 3, "ntask_stop_v": 3, "ntask_alpha_scal": 3, "print": [3, 4], "stat": 3, "termin": 3, "criterion": 3, "factor": 3, "alpha": 3, "print_stat": 3, "stdout": 3, "profile_fit_model": 3, "dure": 3, "stop_metr": 3, "normal": 3, "current": 3, "accuraci": 3, "go": 3, "otherwis": 3, "train_metr": 3, "trace_handl": 3, "p": 3, "catch": 4, "error": 4, "help": 4, "messag": 4, "paramerror": 4, "msg": 4, "debug": 4, "saniti": 4, "validateclcparam": 4, "cli_arg": 4, "specif": 4, "mossaic": 4, "argpars": 4, "where": 4, "come": 4, "data_arg": 4, "yml": 4, "check_abstain_arg": 4, "verifi": 4, "work": 4, "check_data_fil": 4, "exist": 4, "overrid": 4, "check_data_train_arg": 4, "argument": 4, "appropri": 4, "chosen": 4, "train_kwarg": 4, "doc_max_len": 4, "data_kwarg": 4, "clc_arg_check": 4, "mthisan_kwarg": 4, "ceil": 4, "from_pretrain": 4, "some": 4, "copi": 4, "ad": 4, "check_keyword_arg": 4, "check_weight": 4, "hisan_arg_check": 4, "mtcnn_arg_check": 4, "matchesth": 4, "packag": [5, 6], "subpackag": [5, 6], "submodul": [5, 6], "data_setup": [5, 6], "modul": [5, 6], "run_i": [5, 6], "search": 5, "page": 5, "content": 6}, "objects": {"": [[0, 0, 0, "-", "fresco"]], "fresco": [[1, 0, 0, "-", "data_loaders"], [0, 0, 0, "-", "data_setup"], [2, 0, 0, "-", "models"], [0, 0, 0, "-", "run_clc"], [0, 0, 0, "-", "run_ie"], [3, 0, 0, "-", "training"], [4, 0, 0, "-", "validate"]], "fresco.data_loaders": [[1, 0, 0, "-", "data_utils"]], "fresco.data_loaders.data_utils": [[1, 1, 1, "", "AddNoise"], [1, 1, 1, "", "DataHandler"], [1, 1, 1, "", "GroupedCases"], [1, 1, 1, "", "LabelDict"], [1, 1, 1, "", "PathReports"]], "fresco.data_loaders.data_utils.DataHandler": [[1, 2, 1, "", "convert_y"], [1, 3, 1, "", "data_source"], [1, 2, 1, "", "get_vocab"], [1, 2, 1, "", "load_folds"], [1, 2, 1, "", "load_from_saved"], [1, 2, 1, "", "load_weights"], [1, 2, 1, "", "make_grouped_cases"], [1, 2, 1, "", "make_torch_dataloaders"], [1, 3, 1, "", "model_args"], [1, 2, 1, "", "seed_worker"]], "fresco.data_setup": [[0, 4, 1, "", "main"], [0, 4, 1, "", "word2int"]], "fresco.models": [[2, 0, 0, "-", "clc"], [2, 0, 0, "-", "mtcnn"], [2, 0, 0, "-", "mthisan"]], "fresco.models.clc": [[2, 1, 1, "", "CaseLevelContext"]], "fresco.models.clc.CaseLevelContext": [[2, 2, 1, "", "forward"], [2, 3, 1, "", "training"]], "fresco.models.mtcnn": [[2, 1, 1, "", "MTCNN"]], "fresco.models.mtcnn.MTCNN": [[2, 2, 1, "", "forward"], [2, 3, 1, "", "training"]], "fresco.models.mthisan": [[2, 1, 1, "", "MTHiSAN"]], "fresco.models.mthisan.MTHiSAN": [[2, 2, 1, "", "forward"], [2, 3, 1, "", "training"]], "fresco.run_clc": [[0, 4, 1, "", "create_doc_embeddings"], [0, 4, 1, "", "create_model"], [0, 4, 1, "", "load_model"], [0, 4, 1, "", "load_model_dict"], [0, 4, 1, "", "main"], [0, 4, 1, "", "run_case_level"], [0, 4, 1, "", "save_full_model"]], "fresco.run_ie": [[0, 4, 1, "", "create_model"], [0, 4, 1, "", "load_model"], [0, 4, 1, "", "main"], [0, 4, 1, "", "run_ie"], [0, 4, 1, "", "save_full_model"]], "fresco.training": [[3, 0, 0, "-", "training"]], "fresco.training.training": [[3, 1, 1, "", "ModelTrainer"], [3, 4, 1, "", "trace_handler"]], "fresco.training.training.ModelTrainer": [[3, 3, 1, "", "abstain"], [3, 3, 1, "", "best_loss"], [3, 3, 1, "", "class_weights"], [3, 2, 1, "", "compute_clc_loss"], [3, 2, 1, "", "compute_clc_val_loss"], [3, 2, 1, "", "compute_loss"], [3, 2, 1, "", "compute_scores"], [3, 2, 1, "", "compute_val_loss"], [3, 3, 1, "", "device"], [3, 3, 1, "", "dw"], [3, 3, 1, "", "epochs"], [3, 2, 1, "", "fit_model"], [3, 2, 1, "", "get_ys"], [3, 3, 1, "", "keywords"], [3, 3, 1, "", "loss"], [3, 3, 1, "", "loss_funs"], [3, 3, 1, "", "mixed_precision"], [3, 3, 1, "", "model"], [3, 3, 1, "", "multilabel"], [3, 3, 1, "", "n_task"], [3, 3, 1, "", "opt"], [3, 2, 1, "", "output_scores"], [3, 3, 1, "", "patience_ctr"], [3, 3, 1, "", "patience_stop"], [3, 2, 1, "", "print_stats"], [3, 2, 1, "", "profile_fit_model"], [3, 3, 1, "", "reduction"], [3, 3, 1, "", "savepath"], [3, 2, 1, "", "score"], [3, 2, 1, "", "stop_metrics"], [3, 3, 1, "", "tasks"], [3, 2, 1, "", "train_metrics"], [3, 3, 1, "", "y_preds"], [3, 3, 1, "", "y_trues"]], "fresco.validate": [[4, 0, 0, "-", "exceptions"], [4, 0, 0, "-", "validate_params"]], "fresco.validate.exceptions": [[4, 5, 1, "", "ParamError"]], "fresco.validate.validate_params": [[4, 1, 1, "", "ValidateClcParams"], [4, 1, 1, "", "ValidateParams"]], "fresco.validate.validate_params.ValidateClcParams": [[4, 2, 1, "", "check_abstain_args"], [4, 2, 1, "", "check_data_files"], [4, 2, 1, "", "check_data_train_args"], [4, 2, 1, "", "clc_arg_check"]], "fresco.validate.validate_params.ValidateParams": [[4, 2, 1, "", "check_abstain_args"], [4, 2, 1, "", "check_data_files"], [4, 2, 1, "", "check_data_train_args"], [4, 2, 1, "", "check_keyword_args"], [4, 2, 1, "", "check_weights"], [4, 2, 1, "", "hisan_arg_check"], [4, 2, 1, "", "mtcnn_arg_check"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function", "5": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"], "5": ["py", "exception", "Python exception"]}, "titleterms": {"fresco": [0, 1, 2, 3, 4, 5, 6], "packag": [0, 1, 2, 3, 4], "subpackag": 0, "submodul": [0, 1, 2, 3, 4], "data_setup": 0, "modul": [0, 1, 2, 3, 4], "run_clc": 0, "run_i": 0, "content": [0, 1, 2, 3, 4, 5], "data_load": 1, "data_util": 1, "model": 2, "clc": 2, "mtcnn": 2, "mthisan": 2, "train": 3, "valid": 4, "except": 4, "validate_param": 4, "welcom": 5, "s": 5, "document": 5, "indic": 5, "tabl": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})